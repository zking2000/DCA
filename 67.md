âœ… æ­£ç¡®ç­”æ¡ˆï¼šC. UCP audit logs must be set to the â€˜metadataâ€™ or â€˜requestâ€™ level.

â¸»

ğŸ’¡ ä¸€ã€é¢˜ç›®å›é¡¾

Question:
When an application being managed by UCP fails, you would like a summary of all requests made to the UCP API in the hours leading up to the failure.

What must be configured correctly beforehand for this to be possible?

Options:
A. All engines in the cluster must have their log driver set to the â€˜metadataâ€™ or â€˜requestâ€™ level.
B. UCP logging levels must be set to the â€˜infoâ€™ or â€˜debugâ€™ level.
C. UCP audit logs must be set to the â€˜metadataâ€™ or â€˜requestâ€™ level.
D. Set the logging level in the config object for the ucp-kube-apiserver container to â€˜warningâ€™ or higher.

âœ… Answer: C

â¸»

ğŸ§± äºŒã€è€ƒç‚¹ï¼šDocker Enterprise UCPï¼ˆUniversal Control Planeï¼‰çš„å®¡è®¡æ—¥å¿—æœºåˆ¶

UCPï¼ˆDocker Universal Control Planeï¼‰æä¾› Audit Logsï¼ˆå®¡è®¡æ—¥å¿—ï¼‰ åŠŸèƒ½ï¼Œ
å¯ä»¥è®°å½•æ‰€æœ‰é€šè¿‡ UCP APIã€CLIã€Web UI è¿›è¡Œçš„è¯·æ±‚æ“ä½œã€‚

é¢˜ç›®é—®çš„æ˜¯ï¼š

â€œå¸Œæœ›åœ¨åº”ç”¨å¤±è´¥å‰ï¼Œèƒ½å›æº¯æ‰€æœ‰å¯¹ UCP API çš„è¯·æ±‚â€

â€”â€” è¿™æ­£æ˜¯ UCP Audit Logs çš„åŠŸèƒ½ã€‚

â¸»

âš™ï¸ ä¸‰ã€UCP Audit Logs çº§åˆ«è¯¦è§£

UCP çš„å®¡è®¡æ—¥å¿—æ”¯æŒä¸‰ä¸ªçº§åˆ«ï¼ˆlevelï¼‰ï¼š

çº§åˆ«	å«ä¹‰	é€‚ç”¨åœºæ™¯
none	ä¸è®°å½•ä»»ä½•è¯·æ±‚	é»˜è®¤æœ€èŠ‚çœæ€§èƒ½
metadata	è®°å½•è¯·æ±‚çš„å…ƒæ•°æ®ï¼ˆç”¨æˆ·ã€æ—¶é—´ã€API endpointï¼‰	å¸¸ç”¨ï¼Œæ€§èƒ½ä¸å®¡è®¡å¹³è¡¡
request	è®°å½•è¯·æ±‚çš„å®Œæ•´å†…å®¹ï¼ˆå« payloadï¼‰	æœ€è¯¦ç»†ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜


â¸»

âœ… ä¸¾ä¾‹ï¼š

é…ç½® UCP å®¡è®¡æ—¥å¿—ä¸º metadata æˆ– requestï¼š

docker run --rm -it \
  --log-level info \
  docker/ucp:3.3.6 \
  manage-audit --set-level request

ä¹‹åå¯ä»¥åœ¨ UCP çš„æ—¥å¿—è·¯å¾„ä¸­çœ‹åˆ°ï¼š

/var/lib/docker/ucp/audit.log

æ—¥å¿—æ¡ç›®ç¤ºä¾‹ï¼š

{
  "user": "admin",
  "request": "POST /api/ucp/cluster/services",
  "timestamp": "2025-10-06T13:45:21Z",
  "status": "201 Created"
}


â¸»

ğŸ§© å››ã€é€‰é¡¹é€é¡¹åˆ†æ

é€‰é¡¹	æ˜¯å¦æ­£ç¡®	åŸå› 
A. All engines in the cluster must have their log driver set to â€˜metadataâ€™ or â€˜requestâ€™	âŒ å¦	log-driver å±äº Docker Engine å±‚ï¼Œä¸ UCP API æ—¥å¿—æ— å…³
B. UCP logging levels must be set to â€˜infoâ€™ or â€˜debugâ€™	âŒ å¦	info/debug æ˜¯è¿è¡Œæ—¥å¿—çº§åˆ«ï¼Œä¸åŒ…å« API å®¡è®¡è¯·æ±‚å†…å®¹
âœ… C. UCP audit logs must be set to â€˜metadataâ€™ or â€˜requestâ€™ level	âœ… æ­£ç¡®	audit logs æ‰èƒ½è®°å½• API è°ƒç”¨è½¨è¿¹
D. Set the logging level for ucp-kube-apiserver to â€˜warningâ€™ or higher	âŒ å¦	è¿™æ˜¯ Kubernetes å±‚æ—¥å¿—ï¼Œä¸ UCP API å®¡è®¡æœºåˆ¶æ— å…³


â¸»

ğŸ§  äº”ã€æ€»ç»“

è‹¥å¸Œæœ›åœ¨åº”ç”¨å¤±è´¥æ—¶æŸ¥çœ‹ UCP æ¥æ”¶åˆ°çš„æ‰€æœ‰ API è¯·æ±‚å†å²ï¼Œ
å¿…é¡»æå‰å¯ç”¨ UCP Audit Logsï¼Œå¹¶è®¾ç½®ä¸º metadata æˆ– request çº§åˆ«ã€‚

â¸»

âœ… æœ€ç»ˆç­”æ¡ˆï¼šC. UCP audit logs must be set to the â€˜metadataâ€™ or â€˜requestâ€™ level.

å› ä¸ºåªæœ‰ UCP å®¡è®¡æ—¥å¿—ï¼ˆAudit Logsï¼‰ä¼šè®°å½•æ‰€æœ‰ API è°ƒç”¨åŠè¯·æ±‚ä¿¡æ¯ï¼Œç”¨äºäº‹åè¿½è¸ªå’Œé—®é¢˜å®šä½ã€‚