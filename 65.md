✅ 正确答案是：A. Yes

⸻

💡 一、题目回顾

Question:
A company’s security policy specifies that development and production containers must run on separate nodes in a given Swarm cluster.

Solution:
node affinities

Answer: ✅ A. Yes

⸻

🧱 二、考点：Swarm 中的“调度约束（Scheduling Constraints）”

在 Docker Swarm 模式下，服务部署时可以通过 node affinity（节点亲和性） 或 constraints（约束条件）
来控制容器在哪些节点上运行。

这正是实现题目中“让开发环境和生产环境分开运行”的机制。

⸻

⚙️ 三、node affinity（节点亲和性）的原理

Docker Swarm 使用 节点标签（node labels） 来定义节点的特性，
然后在服务部署时使用 --constraint 参数指定调度规则。

例如：

docker node update --label-add env=prod node-1
docker node update --label-add env=dev node-2

然后在部署服务时：

✅ 部署生产环境容器：

docker service create \
  --name web-prod \
  --constraint 'node.labels.env == prod' \
  nginx

✅ 部署开发环境容器：

docker service create \
  --name web-dev \
  --constraint 'node.labels.env == dev' \
  nginx

结果：
	•	所有生产容器只会调度到带有 env=prod 标签的节点；
	•	所有开发容器只会调度到带有 env=dev 标签的节点；
	•	满足安全策略：不同环境的容器运行在不同节点上。

⸻

🧩 四、对比其他 Swarm 调度机制

调度机制	功能	是否满足题意
node affinity / constraint	按标签控制容器在哪些节点运行	✅ 是
placement preferences	优化节点负载分布（例如均衡）	❌ 否
node taints & tolerations	控制哪些服务能容忍特殊节点	✅ 可用于高级隔离
resource limits	控制资源使用	❌ 否（不影响节点分配）


⸻

🧠 五、补充：Swarm “affinity” 与 “constraint” 的区别

名称	含义	使用场景
node affinity / constraint	基于节点标签进行调度（强约束）	指定服务必须在哪些节点上运行
service affinity	基于已有容器或服务进行调度（软约束）	让服务在相同/不同节点上运行（如 service==redis）

在本题中，因为要区分 dev 与 prod 节点 → 用 node affinity。

⸻

✅ 六、总结

目标	实现方式
开发与生产容器必须分开运行	✅ 给节点打标签（node.labels.env=prod/dev）
控制调度策略	✅ 使用 --constraint 或 node affinity
保障安全策略	✅ Swarm 原生支持


⸻

✅ 最终答案：A. Yes

因为 node affinities（节点亲和性）可用于根据节点标签调度容器，
从而保证开发与生产环境运行在不同节点上，符合安全隔离要求。