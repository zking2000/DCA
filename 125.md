✅ 正确答案：A. Matching images are untagged during the next prune job.

⸻

💡 一、题目回顾

Question:
You set up an automatic pruning policy on a Docker Trusted Registry (DTR) repository to prune all images using Apache licenses.

What effect does this have on images in this repository?

Options:
A. Matching images are untagged during the next prune job.
B. Matching images are deleted during the next prune job.
C. Matching images are untagged once they are older than the pruning threshold set in the repository’s Settings tab.
D. Matching images are untagged during the next prune job, and subsequently deleted once they are older than the pruning threshold set in the repository’s Settings tab.

✅ Answer: A

⸻

🧱 二、考点：DTR（Docker Trusted Registry）中的 自动镜像清理（Image Pruning）机制

DTR 支持为仓库配置 自动清理（Pruning）策略，
根据镜像标签、签名、许可证、年龄、扫描结果等条件自动清理镜像。

⸻

⚙️ 三、DTR 自动清理的行为逻辑

⚙️ DTR Prune Job 不会直接删除镜像层（layers）文件。

它只会移除镜像的标签（untag），
这样该镜像就不再被任何 tag 引用。

只有当：
	•	镜像被 untag 后，
	•	且后续运行 DTR Garbage Collection (GC)，
	•	且该镜像的层不再被其他标签或镜像引用时，

这些镜像层才会真正从磁盘删除。

⸻

🧩 四、解释题目中的 “prune Apache license images”

你设置的策略：

prune all images using Apache license

这意味着：
	•	当下一次自动清理任务（prune job）运行时，
	•	所有符合 “Apache license” 条件的镜像：
	•	不会立刻被删除；
	•	而是被 untag（去除标签）；
	•	镜像层仍然保留在 DTR 存储中；
	•	后续若没有其他 tag 指向该镜像，
它会在 GC 执行时被彻底删除。

⸻

🧠 五、选项逐一分析

选项	是否正确	原因
A. Matching images are untagged during the next prune job.	✅ 正确	Prune Job 的行为就是 untag，而非直接删除
B. Matching images are deleted during the next prune job.	❌ 错误	Prune 只 untag，不删除层数据
C. Matching images are untagged once they are older than the pruning threshold set in the repository’s Settings tab.	❌ 错误	题目中没提时间阈值（age threshold），只基于 license 条件
D. Matching images are untagged during the next prune job, and subsequently deleted once they are older than the pruning threshold set in the repository’s Settings tab.	❌ 错误	删除是由 Garbage Collection 决定，不受 prune threshold 影响


⸻

✅ 六、总结

行为阶段	动作	说明
Prune Job	🔹 Untag 镜像	根据策略条件（license, tag, age, etc.）
GC Job	🔹 删除无引用镜像层	真正释放磁盘空间


⸻

✅ 最终答案：A. Matching images are untagged during the next prune job.

因为 DTR 自动清理（Prune）只会去除符合条件镜像的标签，而不会立即删除镜像层文件。